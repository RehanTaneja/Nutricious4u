[95m[2025-11-01 01:07:55.621] 
================================================================================[0m
[95m[2025-11-01 01:07:55.621] COMPREHENSIVE PUSH NOTIFICATION SYSTEM TESTING[0m
[95m[2025-11-01 01:07:55.621] ================================================================================[0m
[96m[2025-11-01 01:07:55.621] ‚ÑπÔ∏è  Backend URL: https://nutricious4u-production.up.railway.app/api[0m
[96m[2025-11-01 01:07:55.621] ‚ÑπÔ∏è  Test started at: 2025-11-01 01:07:55[0m
[95m[2025-11-01 01:07:55.621] 
================================================================================[0m
[95m[2025-11-01 01:07:55.621] TEST 1: Backend Connectivity[0m
[95m[2025-11-01 01:07:55.621] ================================================================================[0m
[96m[2025-11-01 01:07:55.621] ‚ÑπÔ∏è  Testing connection to: https://nutricious4u-production.up.railway.app/api/[0m
[96m[2025-11-01 01:07:55.956] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:07:55.956] ‚ÑπÔ∏è  Response text: {"message":"Fitness Tracker API is running!"}[0m
[92m[2025-11-01 01:07:55.956] ‚úÖ Backend is reachable[0m
[95m[2025-11-01 01:07:55.958] 
================================================================================[0m
[95m[2025-11-01 01:07:55.958] TEST 2: Push Notification Endpoint Availability[0m
[95m[2025-11-01 01:07:55.958] ================================================================================[0m
[96m[2025-11-01 01:07:55.958] ‚ÑπÔ∏è  Testing endpoint: https://nutricious4u-production.up.railway.app/api/push-notifications/send[0m
[96m[2025-11-01 01:07:56.304] ‚ÑπÔ∏è  Response status: 400[0m
[96m[2025-11-01 01:07:56.304] ‚ÑπÔ∏è  Response body: {"detail":"Invalid notification type"}[0m
[92m[2025-11-01 01:07:56.304] ‚úÖ Push notification endpoint exists (status 400)[0m
[95m[2025-11-01 01:07:56.306] 
================================================================================[0m
[95m[2025-11-01 01:07:56.306] Getting Users List[0m
[95m[2025-11-01 01:07:56.307] ================================================================================[0m
[93m[2025-11-01 01:07:56.307] ‚ö†Ô∏è  No /users endpoint available, using test data[0m
[93m[2025-11-01 01:07:56.307] ‚ö†Ô∏è  No users found. Using default test user.[0m
[95m[2025-11-01 01:07:56.307] 
================================================================================[0m
[95m[2025-11-01 01:07:56.307] Getting Token for User: dietician[0m
[95m[2025-11-01 01:07:56.307] ================================================================================[0m
[96m[2025-11-01 01:07:56.307] ‚ÑπÔ∏è  Calling debug endpoint: /notifications/debug/token/dietician[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Response body: {
  "userId": "dietician",
  "timestamp": "2025-11-01T05:07:56.593730",
  "tokenFound": false,
  "tokenPreview": null,
  "tokenValid": false,
  "platform": null,
  "lastUpdate": null,
  "isDietician": true,
  "errors": [
    "No dietician token found in database"
  ]
}[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Token found: False[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Token valid: False[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Token preview: None[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Platform: None[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Last update: None[0m
[96m[2025-11-01 01:07:58.917] ‚ÑπÔ∏è  Is dietician: True[0m
[93m[2025-11-01 01:07:58.917] ‚ö†Ô∏è  Errors: ['No dietician token found in database'][0m
[91m[2025-11-01 01:07:58.917] ‚ùå No valid token for dietician[0m
[95m[2025-11-01 01:07:58.920] 
================================================================================[0m
[95m[2025-11-01 01:07:58.920] Getting Token for User: test_user_123[0m
[95m[2025-11-01 01:07:58.920] ================================================================================[0m
[96m[2025-11-01 01:07:58.920] ‚ÑπÔ∏è  Calling debug endpoint: /notifications/debug/token/test_user_123[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Response body: {
  "userId": "test_user_123",
  "timestamp": "2025-11-01T05:07:59.278439",
  "tokenFound": false,
  "tokenPreview": null,
  "tokenValid": false,
  "platform": null,
  "lastUpdate": null,
  "isDietician": false,
  "errors": [
    "No token found in user document",
    "User needs to log into mobile app to register for notifications"
  ]
}[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Token found: False[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Token valid: False[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Token preview: None[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Platform: None[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Last update: None[0m
[96m[2025-11-01 01:07:59.720] ‚ÑπÔ∏è  Is dietician: False[0m
[93m[2025-11-01 01:07:59.720] ‚ö†Ô∏è  Errors: ['No token found in user document', 'User needs to log into mobile app to register for notifications'][0m
[91m[2025-11-01 01:07:59.720] ‚ùå No valid token for test_user_123[0m
[95m[2025-11-01 01:07:59.722] 
================================================================================[0m
[95m[2025-11-01 01:07:59.722] TEST 3: Message Notification (User ‚Üí Dietician)[0m
[95m[2025-11-01 01:07:59.722] ================================================================================[0m
[96m[2025-11-01 01:07:59.722] ‚ÑπÔ∏è  Sender: Test User (ID: test_user_123)[0m
[96m[2025-11-01 01:07:59.722] ‚ÑπÔ∏è  Recipient: Dietician[0m
[96m[2025-11-01 01:07:59.722] ‚ÑπÔ∏è  Notification payload:[0m
[96m[2025-11-01 01:07:59.723] ‚ÑπÔ∏è  {
  "type": "message",
  "recipientId": "dietician",
  "senderName": "Test User",
  "message": "Hello dietician! This is a test message.",
  "isFromDietician": false
}[0m
[96m[2025-11-01 01:07:59.723] ‚ÑπÔ∏è  Sending POST to: https://nutricious4u-production.up.railway.app/api/push-notifications/send[0m
[96m[2025-11-01 01:08:01.666] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:08:01.666] ‚ÑπÔ∏è  Response body: {"success":false}[0m
[91m[2025-11-01 01:08:01.666] ‚ùå Message notification failed (success=false)[0m
[95m[2025-11-01 01:08:03.674] 
================================================================================[0m
[95m[2025-11-01 01:08:03.674] TEST 4: Message Notification (Dietician ‚Üí User)[0m
[95m[2025-11-01 01:08:03.674] ================================================================================[0m
[96m[2025-11-01 01:08:03.674] ‚ÑπÔ∏è  Sender: Dietician[0m
[96m[2025-11-01 01:08:03.674] ‚ÑπÔ∏è  Recipient: Test User (ID: test_user_123)[0m
[96m[2025-11-01 01:08:03.674] ‚ÑπÔ∏è  Notification payload:[0m
[96m[2025-11-01 01:08:03.674] ‚ÑπÔ∏è  {
  "type": "message",
  "recipientId": "test_user_123",
  "senderName": "Dietician",
  "message": "Hello! This is a test message from your dietician.",
  "isFromDietician": true
}[0m
[96m[2025-11-01 01:08:03.674] ‚ÑπÔ∏è  Sending POST to: https://nutricious4u-production.up.railway.app/api/push-notifications/send[0m
[96m[2025-11-01 01:08:04.283] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:08:04.283] ‚ÑπÔ∏è  Response body: {"success":false}[0m
[91m[2025-11-01 01:08:04.283] ‚ùå Message notification failed (success=false)[0m
[95m[2025-11-01 01:08:06.290] 
================================================================================[0m
[95m[2025-11-01 01:08:06.290] TEST 5: Appointment Scheduled Notification[0m
[95m[2025-11-01 01:08:06.290] ================================================================================[0m
[96m[2025-11-01 01:08:06.290] ‚ÑπÔ∏è  User: Test User[0m
[96m[2025-11-01 01:08:06.290] ‚ÑπÔ∏è  Date: 2025-11-02[0m
[96m[2025-11-01 01:08:06.290] ‚ÑπÔ∏è  Time: 10:00 AM[0m
[96m[2025-11-01 01:08:06.290] ‚ÑπÔ∏è  Notification payload:[0m
[96m[2025-11-01 01:08:06.290] ‚ÑπÔ∏è  {
  "type": "appointment_scheduled",
  "userName": "Test User",
  "date": "2025-11-02",
  "timeSlot": "10:00 AM"
}[0m
[96m[2025-11-01 01:08:06.290] ‚ÑπÔ∏è  Sending POST to: https://nutricious4u-production.up.railway.app/api/push-notifications/send[0m
[96m[2025-11-01 01:08:06.990] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:08:06.991] ‚ÑπÔ∏è  Response body: {"success":false}[0m
[91m[2025-11-01 01:08:06.991] ‚ùå Appointment notification failed (success=false)[0m
[95m[2025-11-01 01:08:08.995] 
================================================================================[0m
[95m[2025-11-01 01:08:08.995] TEST 6: Appointment Cancelled Notification[0m
[95m[2025-11-01 01:08:08.995] ================================================================================[0m
[96m[2025-11-01 01:08:08.995] ‚ÑπÔ∏è  User: Test User[0m
[96m[2025-11-01 01:08:08.995] ‚ÑπÔ∏è  Date: 2025-11-02[0m
[96m[2025-11-01 01:08:08.995] ‚ÑπÔ∏è  Time: 10:00 AM[0m
[96m[2025-11-01 01:08:08.995] ‚ÑπÔ∏è  Notification payload:[0m
[96m[2025-11-01 01:08:08.995] ‚ÑπÔ∏è  {
  "type": "appointment_cancelled",
  "userName": "Test User",
  "date": "2025-11-02",
  "timeSlot": "10:00 AM"
}[0m
[96m[2025-11-01 01:08:08.995] ‚ÑπÔ∏è  Sending POST to: https://nutricious4u-production.up.railway.app/api/push-notifications/send[0m
[96m[2025-11-01 01:08:09.632] ‚ÑπÔ∏è  Response status: 200[0m
[96m[2025-11-01 01:08:09.632] ‚ÑπÔ∏è  Response body: {"success":false}[0m
[91m[2025-11-01 01:08:09.632] ‚ùå Appointment notification failed (success=false)[0m
[95m[2025-11-01 01:08:09.634] 
================================================================================[0m
[95m[2025-11-01 01:08:09.634] TEST SUMMARY[0m
[95m[2025-11-01 01:08:09.634] ================================================================================[0m
[96m[2025-11-01 01:08:09.634] ‚ÑπÔ∏è  Total tests: 8[0m
[92m[2025-11-01 01:08:09.634] ‚úÖ Passed: 2[0m
[91m[2025-11-01 01:08:09.634] ‚ùå Failed: 6[0m
[94m[2025-11-01 01:08:09.634] ‚úÖ PASS: Backend Connectivity[0m
[94m[2025-11-01 01:08:09.634] ‚úÖ PASS: Push Notification Endpoint[0m
[94m[2025-11-01 01:08:09.634] ‚ùå FAIL: Dietician Token[0m
[94m[2025-11-01 01:08:09.634] ‚ùå FAIL: User Token[0m
[94m[2025-11-01 01:08:09.634] ‚ùå FAIL: Message Notification (User ‚Üí Dietician)[0m
[94m[2025-11-01 01:08:09.634] ‚ùå FAIL: Message Notification (Dietician ‚Üí User)[0m
[94m[2025-11-01 01:08:09.634] ‚ùå FAIL: Appointment Scheduled Notification[0m
[94m[2025-11-01 01:08:09.634] ‚ùå FAIL: Appointment Cancelled Notification[0m
[92m[2025-11-01 01:08:09.635] ‚úÖ Results saved to: push_notification_test_results_20251101_010809.json[0m
